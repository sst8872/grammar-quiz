{"id":"js/app.js","dependencies":[{"name":"C:\\Users\\user\\Desktop\\projects\\amost-finished-NEVER-DELEVE\\grammar-quiz-modal\\package.json","includedInParent":true,"mtime":1574686380394},{"name":"./modal","loc":{"line":1,"column":22},"parent":"C:\\Users\\user\\Desktop\\projects\\amost-finished-NEVER-DELEVE\\grammar-quiz-modal\\js\\app.js","resolved":"C:\\Users\\user\\Desktop\\projects\\amost-finished-NEVER-DELEVE\\grammar-quiz-modal\\js\\modal.js"}],"generated":{"js":"\"use strict\";\n\nvar _modal = _interopRequireDefault(require(\"./modal\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\n(0, _modal.default)();\n\nvar app = function () {\n  // Spreadsheet json feed\n  var feedID = \"1nnCrmaEtLiaVTfWmgRdaR9GW_SJE9tR-XSAEtskMWPM\";\n  var myData = []; // Object for spreadsheet data\n\n  var game = {}; // Object for game data\n\n  var tempHint = {}; // Dom elements\n\n  var peterBox = document.querySelector(\".peter-box\");\n  var dropDownList = document.querySelector(\"#dropDownList\");\n  var index = document.querySelector('.index');\n  var output = document.querySelector(\".output\"); // Load jason data from spreadsheets\n\n  function init() {\n    getLength();\n  }\n\n  function getLength() {\n    var url = 'https://script.google.com/macros/s/AKfycbziQxGY0Qwqp9fS0-kDmtc6cOyJekx-dxBz_B2KB-DSErzJgc2m/exec';\n    fetch(url).then(function (res) {\n      return res.json();\n    }).then(function (data) {\n      loadJSON(data);\n    });\n  } // Load data into Dom\n\n\n  function loadOutput() {\n    // Drop down list\n    var select = document.createElement(\"select\");\n    select.classList.add(\"select-css\");\n    var firstRun = true;\n\n    for (var key in myData) {\n      // key: sheet name, slect option name\n      var option = document.createElement(\"option\");\n      option.value = key;\n      option.textContent = key;\n      select.appendChild(option);\n\n      if (firstRun) {\n        firstRun = false;\n        quizBuilder(key);\n      }\n    }\n\n    select.addEventListener(\"change\", outputQuiz);\n    dropDownList.appendChild(select);\n  } // Load quiz builder\n\n\n  function outputQuiz(e) {\n    // e.target.value => option value\n    quizBuilder(e.target.value);\n  } // Making a quiz set\n\n\n  function quizBuilder(quizName) {\n    game.page = 0;\n    game.score = 0;\n    game.curQuiz = shuffleArray(myData[quizName]);\n    console.log(game.curQuiz);\n    game.totalQuestions = game.curQuiz.length; // Load actual questions\n\n    questionBuilder();\n  }\n\n  function percentage(partialV, totalV) {\n    return Math.floor(100 * partialV / totalV);\n  } // Actual quiz\n\n\n  function questionBuilder() {\n    var holder = game.curQuiz[game.page];\n    output.innerHTML = \"\";\n    peterBox.innerHTML = \"\";\n    index.innerHTML = '';\n    document.querySelector('.box').style.borderBottomColor = '#03a9f2';\n\n    if (game.page >= game.totalQuestions) {\n      var playerScore = percentage(game.score, game.totalQuestions);\n      output.innerHTML = \"<div class=\\\"scoreOutput\\\">Game Over</div>\";\n      output.innerHTML += \"<div class=\\\"scoreOutput\\\">Your score is \".concat(playerScore, \"%</div>\");\n      document.querySelector('.box').style.borderBottomColor = '#f6f6f6';\n    } else {\n      var h2 = document.createElement(\"h2\");\n      var h2Text = document.createTextNode(\"\".concat(holder.question));\n      h2.appendChild(h2Text);\n      output.appendChild(h2); // Build a question\n\n      var tempArray = [];\n      tempHint.correct = holder['correct'];\n      tempHint.kor = holder['kor'];\n      tempHint.exp = holder['exp'];\n      tempHint.question = holder['question'];\n\n      for (var key in holder) {\n        if (key != \"question\" && key != 'kor' && key != 'exp') {\n          var ans = holder[key];\n          var res = false;\n\n          if (key == \"correct\") {\n            res = true;\n          }\n\n          if (ans) {\n            tempArray = [].concat(_toConsumableArray(tempArray), [{\n              answer: ans,\n              status: res\n            }]);\n          }\n        }\n      }\n\n      shuffleArray(tempArray);\n      var ul = document.createElement(\"ul\");\n      tempArray.forEach(function (answer, i) {\n        var li = document.createElement(\"li\");\n        li.textContent = tempArray[i].answer;\n        li.checkMe = tempArray[i].status;\n        li.addEventListener(\"click\", checkAnswer);\n        li.insertAdjacentHTML(\"afterbegin\", \"<span>\".concat(i + 1, \"</span>\"));\n        ul.appendChild(li);\n      });\n\n      var _index = document.createElement('div');\n\n      _index.setAttribute('class', 'index');\n\n      _index.innerHTML = \"<span class=\\\"index\\\">\".concat(game.page + 1, \" / \").concat(game.curQuiz.length, \"</span>\");\n      document.querySelector('.index').appendChild(_index);\n      output.appendChild(ul);\n    }\n  }\n\n  function shuffleArray(array) {\n    for (var i = array.length - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n    }\n\n    return array;\n  } // Check if the answer is correct\n\n\n  function checkAnswer(e) {\n    var modalBtn = document.querySelector('.modalBtn');\n    modalBtn.style.display = 'block';\n    modalBtn.addEventListener('click', showHint);\n    var responder = \"Sorry, Incorrect\";\n    var resClass = e.target.checkMe ? 'green' : 'red';\n\n    if (e.target.checkMe) {\n      game.score++;\n      responder = \"Correct\";\n    }\n\n    game.page++;\n    var lis = document.querySelectorAll(\"li\");\n    lis.forEach(function (li) {\n      li.removeEventListener(\"click\", checkAnswer);\n    }); // EventListener for hint\n    // Show responder button\n\n    var div = document.createElement(\"div\");\n    var nextText = \"Next Question\";\n\n    if (game.page >= game.totalQuestions) {\n      nextText = \"See Results\";\n    }\n\n    div.innerHTML = \" \\n                <h4 class=\".concat(resClass, \">\").concat(responder, \"</h4>\\n                <p>\\n                <input \\n                    type=\\\"submit\\\" \\n                    value=\\\"\").concat(nextText, \"\\\"\\n                    class=\\\"peter-button\\\" \\n                    /> \\n                </p>\");\n    div.addEventListener(\"click\", function () {\n      document.querySelector('.modalBtn').style.display = 'none';\n      document.querySelector('.h2').textContent = '';\n      document.querySelector('.question').textContent = '';\n      document.querySelector('.kor').textContent = '';\n      document.querySelector('.exp').textContent = '';\n      document.querySelector('.modalWrapper').classList.remove('showModal');\n      questionBuilder();\n    });\n    peterBox.appendChild(div);\n  }\n\n  function showHint(e) {\n    document.querySelector('.h2').textContent = '정답 ' + tempHint.correct;\n    document.querySelector('.question').textContent = '[문제] ' + tempHint.question;\n    document.querySelector('.kor').textContent = tempHint.kor;\n    document.querySelector('.exp').textContent = tempHint.exp;\n    return;\n  }\n\n  function loadJSON(sheetLen) {\n    var urls = [];\n\n    for (var sheetNum = 1; sheetNum <= sheetLen; sheetNum++) {\n      var jsonURL = \"https://spreadsheets.google.com/feeds/list/\".concat(feedID, \"/\").concat(sheetNum, \"/public/values?alt=json\");\n      urls = [].concat(_toConsumableArray(urls), [jsonURL]);\n    } // Promise all - fetch all spread sheets data\n\n\n    Promise.all(urls.map(function (url) {\n      return fetch(url).then(function (res) {\n        return res.json();\n      }).then(function (data) {\n        var tempArray = [];\n        var sheetName = data.feed.title.$t;\n        data.feed.entry.forEach(function (element) {\n          var holder = {};\n\n          for (var key in element) {\n            if (key.substring(0, 3) === \"gsx\") {\n              holder[key.split(\"$\")[1]] = element[key].$t;\n            }\n          }\n\n          tempArray = [].concat(_toConsumableArray(tempArray), [holder]);\n        });\n        return {\n          key: sheetName,\n          value: tempArray //   [sheetName]: tempArray\n\n        };\n      });\n    })).then(function (result) {\n      // Make globaldata object from spreadsheets\n      result.forEach(function (item, i) {\n        myData[result[i].key] = result[i].value;\n      });\n      var loader = document.querySelector('.loader').style.display = 'none';\n      var box = document.querySelector('.box').style.display = 'block';\n      document.querySelector('.modal').style.display = 'block';\n      loadOutput();\n    });\n  }\n\n  return {\n    init: init\n  };\n}();\n\ndocument.addEventListener(\"DOMContentLoaded\", app.init);"},"sourceMaps":null,"error":null,"hash":"349220bea00d6076b3e07ccabfcdbd16","cacheData":{"env":{}}}